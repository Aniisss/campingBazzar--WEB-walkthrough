"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9422],{69623:function(e,t,n){var i,l;n.d(t,{PR:function(){return o},n7:function(){return s}}),(l=i||(i={})).KEYBOARD_PRESS="keyboard_action",l.KEYBOARD_SEQUENCE="keyboard_sequence_action",l.KEYBOARD_COMBINATION="keyboard_combination_action",l.MOUSE_CLICK="mouse_click_action",l.MOUSE_START_DRAG="mouse_start_drag_action",l.MOUSE_END_DRAG="mouse_end_drag_action",l.MOUSE_CANCEL_DRAG="mouse_cancel_drag_action",l.INSTRUCTION="instruction",l.STACK="stack",l.SECTION="section",l.TIP="tip",l.WARNING="warning",l.DISABLED="disabled",i.KEYBOARD_PRESS,i.KEYBOARD_SEQUENCE,i.KEYBOARD_COMBINATION,i.MOUSE_CLICK,i.MOUSE_START_DRAG,i.MOUSE_END_DRAG,i.MOUSE_CANCEL_DRAG,i.INSTRUCTION,i.STACK,i.SECTION,i.TIP,i.WARNING,i.DISABLED,i.KEYBOARD_SEQUENCE,i.KEYBOARD_COMBINATION,i.MOUSE_CLICK,i.MOUSE_START_DRAG,i.MOUSE_END_DRAG,i.INSTRUCTION,i.STACK,i.SECTION,i.TIP,i.WARNING,i.DISABLED;let r=[i.KEYBOARD_PRESS,i.KEYBOARD_SEQUENCE,i.KEYBOARD_COMBINATION,i.MOUSE_CLICK,i.MOUSE_START_DRAG,i.MOUSE_END_DRAG];[...r.filter(e=>![i.KEYBOARD_PRESS].includes(e))];let o=[i.KEYBOARD_SEQUENCE,i.KEYBOARD_COMBINATION,i.MOUSE_CLICK,i.MOUSE_START_DRAG,i.MOUSE_END_DRAG,i.INSTRUCTION,i.STACK],s=[...o.filter(e=>e.startsWith("mouse"))];r.filter(e=>e.startsWith("mouse")),r.filter(e=>e.startsWith("keyboard"))},77597:function(e,t,n){n.d(t,{L:function(){return i},h:function(){return l}});let i=e=>"Failed to save file."===e,l=e=>e.startsWith("Unsupported image type. Supported image types are")},35094:function(e,t,n){n.d(t,{Z:function(){return V}});var i=n(24246),l=n(22107),r=n(94033),o=n(28620),s=n(16985),a=n(82789),c=n(14071),d=n(53355),u=n(53583);let h=d.hj.create({name:"keyboardShortcuts",addKeyboardShortcuts(){return{Escape:()=>(this.editor.view.dom.blur(),!0),"Mod-Enter":()=>(this.editor.view.dom.blur(),!0)}}});var p=n(9654),x=n(2412),m=n(29088),f=n(45208),g=n(27378),v=n(37634),b=n(16125),_=n(8022),y=n(66823),j=n(22967),w=n(42171),k=n(83469),S=n(55781),C=e=>{let{onBold:t,onItalic:n,onEditLink:r,onChip:o,onBulletList:s,onOrderedList:a,editor:c,isHidden:d}=e;return(0,i.jsxs)("div",{className:(0,j.cn)("relative flex gap-1 rounded-lg bg-slate-800 p-[6px] shadow-lg",{hidden:d}),children:[(0,i.jsx)(S.Z,{onClick:t,isActive:"bold",editor:c,dataTestID:"bubbleMenuBold",icon:k.c_t,activeIcon:l.c_t}),(0,i.jsx)(S.Z,{onClick:n,isActive:"italic",editor:c,dataTestID:"bubbleMenuItalic",icon:k.cJz,activeIcon:l.cJz}),(0,i.jsx)(S.Z,{onClick:r,isActive:"link",editor:c,dataTestID:"bubbleMenuLink",icon:k.nNP,activeIcon:l.nNP}),(0,i.jsx)(S.Z,{onClick:o,isActive:"chip",editor:c,dataTestID:"bubbleMenuCode",icon:k.dT$,activeIcon:l.dT$}),(0,i.jsx)(S.Z,{onClick:s,isActive:"bulletList",editor:c,dataTestID:"bubbleMenuBulletList",icon:k.Zrf,activeIcon:l.Zrf}),(0,i.jsx)(S.Z,{onClick:a,isActive:"orderedList",editor:c,dataTestID:"bubbleMenuOrderedList",icon:k.nFo,activeIcon:l.nFo})]})},E=e=>{let{maxHeight:t="600px",children:n,disabled:l=!0,gradient:r,setIsCollapsed:o}=e,[s,a]=(0,g.useState)(!1),[c,d]=(0,g.useState)(!1),[u,h]=(0,g.useState)(t),p=(0,g.useRef)(null),x=()=>{if(p.current){let e=p.current.scrollHeight>parseInt(t,10);a(e),e&&!c?(null==o||o(!0),h(t)):(h("".concat(p.current.scrollHeight,"px")),null==o||o(!1))}};return((0,g.useEffect)(()=>(window.addEventListener("resize",x),x(),()=>{window.removeEventListener("resize",x)}),[n,t,c]),l)?(0,i.jsx)(i.Fragment,{children:n}):(0,i.jsxs)("div",{className:"relative flex-grow",children:[(0,i.jsx)("div",{ref:p,className:(0,j.cn)("overflow-hidden transition-all duration-700 ease-in-out",{"mb-8":s}),style:{maxHeight:u},children:n}),s&&(0,i.jsxs)("div",{className:"absolute bottom-0 left-0 right-0",children:[(0,i.jsx)("div",{className:(0,j.cn)("absolute bottom-0 left-0 right-0 h-20 bg-gradient-to-t",c?"":"from-".concat(r.from," to-").concat(r.to))}),(0,i.jsx)("button",{onClick:()=>{d(!c)},className:"absolute left-0 right-0 flex h-8 w-full cursor-pointer items-center justify-center bg-transparent text-center transition-colors duration-200 hover:bg-opacity-10",children:c?"Show Less":"Read More..."})]})]})};let N={warning:"border-red-50",tip:"border-green-50"},T={warning:"red-50",tip:"green-50",default:"white"},I={warning:"hover:bg-rose-100/50",tip:"hover:bg-emerald-100/50"};var A=e=>{let{kind:t,mode:n,content:k,documentId:S,colors:A="",canEdit:L,collapsable:R=!1,setIsCollapsed:M=()=>{},isEmbedded:O=!1,setIsEditing:D=()=>{},updateActionDescription:P=()=>{}}=e,{initialClientSideActionLoadComplete:B}=(0,b.v9)(_.JR),F=L?N[t]||"border-white":"border-none",U=T[t]||T.default,Z=I[t]||"hover:bg-slate-50",[z,G]=(0,g.useState)(!1),K=new RegExp("\\.(".concat("biz|com|edu|gov|net|org|pro|web|xxx|aero|asia|coop|info|museum|name|shop",")(?![a-zA-Z])")),[W,H]=(0,g.useState)(!1),[Y,q]=(0,g.useState)(""),J=(0,g.useRef)(null),[$,Q]=(0,g.useState)(0),V=(0,g.useRef)(null),X=()=>{var e,t;let n=null===(t=J.current)||void 0===t?void 0:null===(e=t.contentComponent)||void 0===e?void 0:e.editorContentRef.current;n&&n.querySelectorAll("a").forEach(e=>{let t=(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{dangerouslySetInnerHTML:{__html:f.Z.sanitize(e.innerHTML)}}),(0,i.jsx)("span",{className:"absolute right-1",children:(0,i.jsx)(r.G,{icon:l.wlW,className:"ml-1 text-blue-400",size:"sm"})})]});(0,v.createRoot)(e).render(t)})},ee=e=>{let{descriptionChanged:t}=e;t&&J.current?Q(0):V.current&&Q(V.current.scrollHeight)},et=(0,c.jE)({content:k,extensions:[u.Z.configure({codeBlock:!1,hardBreak:{keepMarks:!0},orderedList:{HTMLAttributes:{class:"not-prose !list-decimal"}},heading:{HTMLAttributes:{class:"heading md:text-base text-sm"}},paragraph:{HTMLAttributes:{class:"public-sans md:text-base text-sm"}},bulletList:{HTMLAttributes:{class:"not-prose"}},bold:{HTMLAttributes:{class:"font-bold not-prose text-inherit"}}}),y.U.configure({html:!1,tightLists:!0,tightListClass:"tight",bulletListMarker:"-",linkify:!1,breaks:!0,transformPastedText:!0,transformCopiedText:L}),o.Z.configure({className:"group is-focused"}),p.Z.extend({addKeyboardShortcuts:()=>({"Mod-k":en})}).configure({autolink:!0,validate:e=>K.test(e),linkOnPaste:!0,openOnClick:!1,HTMLAttributes:{class:(0,x.UJ)({isLink:!0,isEditing:L,isEmbedded:O})}}),s.Z.configure({types:["heading","paragraph"]}),x.ee,h],editable:L,autofocus:!1,editorProps:{attributes:{class:(0,j.cn)("cy-testing prose action-description focus:outline-none p-1 border leading-6 rounded-lg transition-colors duration-150 break-words focus:border-indigo-400 focus:bg-white","".concat(F," ").concat(A," ").concat(L?"cursor-text ".concat(Z):A),{"max-w-[840px]":O})}},onBlur:e=>{let{editor:t}=e;if(z||W)return;let n=t.storage.markdown.getMarkdown();D(!1),P({text:n})},onFocus:()=>{D(!0)},onCreate:()=>{$||ee({descriptionChanged:!1})},onUpdate:()=>{ee({descriptionChanged:JSON.stringify(k)!==JSON.stringify(et.getText())})}},[L,k]);(0,g.useEffect)(()=>{et&&(J.current=et),!L&&B&&X()},[J,et,L,B]);let en=e=>{if(e){let{editor:t}=e;if(null==t?void 0:t.state.selection.empty)return!1}return"false"!==et.getAttributes("link").href?q(et.getAttributes("link").href):q(""),H(!0),!0};(0,g.useEffect)(()=>{z&&(0,w.L9)("show_rich_text_menu",{scribeId:S})},[z,S]);let ei=e=>{let t={hyperlink:en,bold:et.chain().focus().toggleBold(),italics:et.chain().focus().toggleItalic(),chip:et.chain().focus().toggleChip(),bulleted_list:et.chain().focus().toggleBulletList(),numerical_list:et.chain().focus().toggleOrderedList()}[e];t&&(t===en?t():t.run(),(0,w.L9)("selected_".concat(e,"_rich_text"),{scribeId:S}))};return B||O||"recording"===n?(0,i.jsxs)(i.Fragment,{children:[W&&(0,i.jsx)(m.Z,{onCancel:()=>{H(!1)},onSubmit:e=>{var t,n,i,l,r,o,s,c,d,u;null==et||null===(i=et.chain())||void 0===i||null===(n=i.focus())||void 0===n||null===(t=n.setLink({href:e,target:"_blank"}))||void 0===t||t.run(),H(!1);let h=new a.Bs(null==et?void 0:null===(o=et.view)||void 0===o?void 0:null===(r=o.state)||void 0===r?void 0:null===(l=r.selection)||void 0===l?void 0:l.$to);et.view.dispatch(null==et?void 0:null===(d=et.view)||void 0===d?void 0:null===(c=d.state)||void 0===c?void 0:null===(s=c.tr)||void 0===s?void 0:s.setSelection(h)),null==et||null===(u=et.commands)||void 0===u||u.toggleMark("link")},value:Y,onChange:e=>{q(e.target.value)},onRemoveLink:()=>{et.chain().focus().unsetLink().run(),H(!1)}}),(0,i.jsxs)("div",{ref:V,children:[et&&(0,i.jsx)(c.NM,{editor:et,shouldShow:e=>{let{view:t,state:n,from:i,to:l}=e,{doc:r,selection:o}=n,{empty:s}=o,a=!r.textBetween(i,l).length&&(0,d.xh)(n.selection);return!t.hasFocus()||s||a?(G(!1),!1):(G(!0),!0)},pluginKey:"bubble-menu",tippyOptions:{onClickOutside:()=>(W||G(!1),!1)},children:(0,i.jsx)(C,{isHidden:W,onBold:()=>ei("bold"),onItalic:()=>ei("italics"),onEditLink:()=>ei("hyperlink"),onChip:()=>ei("chip"),onBulletList:()=>ei("bulleted_list"),onOrderedList:()=>ei("numerical_list"),editor:et})}),(0,i.jsx)(E,{gradient:{from:U},maxHeight:"180px",disabled:!R,setIsCollapsed:M,children:(0,i.jsx)(c.kg,{editor:et,className:"cy-editor test-editor h-full w-full first:border-none",ref:J,style:{...!O&&{minHeight:$}},"data-testid":"action-description-editor-content"})})]})]}):(0,i.jsx)("div",{children:k})},L=n(73943),R=n(16863),M=n(55766),O=n(56985),D=n(42135),P=n(1581),B=n(85878),F=n(93910),U=n(51565),Z=e=>{let{kind:t,ordinal:n,isMobileDevice:l}=e;return(0,i.jsx)("div",{className:(0,j.cn)(["absolute flex opacity-100 transition-all group-hover:opacity-0 group-focus:opacity-0"],{"group-hover:opacity-100 group-focus:opacity-100":l}),children:"warning"!==t&&"tip"!==t?(0,i.jsx)("span",{className:(0,j.cn)(["text-lg"],{"text-sm":l}),children:n}):"warning"===t?(0,i.jsx)(U._l2,{size:l?18:20,title:"alert ordinal icon"}):(0,i.jsx)(U.tbY,{size:l?22:24,title:"information ordinal icon"})})};let z=e=>"warning"===e?"bg-red-500 text-white":"tip"===e?"bg-green-200 text-green-600":"disabled"===e?"border border-slate-200 text-slate-400":"bg-indigo-50 text-indigo-500 font-bold",G=e=>{let{kind:t,ordinal:n,onCopyLinkToStep:l,setIsCopied:o,multiSelectModeOn:s,selected:a,onSelectedChange:c,selectDisabled:d,handleShiftClick:u,shouldShowCheckbox:h,mode:p,isMobileDevice:x,isCopied:m,isTranscribing:f}=e,g=!["warning","tip"].includes(t),v=g?"step-".concat(n):t;return(0,D.m)(p)||h||s?(0,i.jsxs)("label",{htmlFor:v,className:"group mr-3 flex h-8 w-8 flex-shrink-0 cursor-pointer flex-col items-center justify-center rounded-full font-sans text-base md:h-10 md:w-10 ".concat(z(t)),"aria-label":g?"Select Step ".concat(n):"Select ".concat(t),children:[!s&&(0,i.jsx)(Z,{kind:t,ordinal:n}),(0,i.jsx)("div",{className:(0,j.cn)(["absolute opacity-0 transition-all group-hover:opacity-100 group-focus:opacity-100",(a||s)&&"opacity-100",d&&"!opacity-0"]),children:(0,i.jsx)(F.Z,{checked:a,onClick:e=>{e.shiftKey?null==u||u(e):null==c||c(!a),(0,w.L9)(a?"unchecked_scribe_steps":"checked_scribe_steps",{location:"snackbar_step_actions"})},disabled:d,className:"mt-0 cursor-pointer",id:v})})]}):"recording"===p?(0,i.jsx)("div",{className:(0,j.cn)("group mr-3 flex h-8 w-8 flex-shrink-0 flex-col items-center justify-center rounded-full font-sans text-base md:h-10 md:w-10",z(t),{"animate-pulse-animation":f}),children:(0,i.jsx)(Z,{kind:t,ordinal:n,isMobileDevice:x})}):(0,i.jsxs)("button",{className:"group mr-3 flex h-8 w-8 flex-shrink-0 cursor-pointer flex-col items-center justify-center rounded-full font-sans text-base md:h-10 md:w-10 ".concat(z(t)),"aria-label":g?"Step ".concat(n," (click to copy link)"):"".concat(t," (click to copy link)"),onClick:e=>{var t;null==l||l(),o(!0),setTimeout(()=>{o(!1)},800),null===(t=e.currentTarget)||void 0===t||t.blur()},children:[(0,i.jsx)("div",{className:(0,j.cn)(["absolute opacity-0 transition-all group-hover:opacity-100 group-focus:opacity-100"]),children:!x&&(0,i.jsx)(r.G,{icon:m?k.LEp:k.nNP})}),(0,i.jsx)(Z,{kind:t,ordinal:n,isMobileDevice:x})]})},K=()=>null;var W=e=>(0,i.jsx)(L.Z,{fallback:K,children:(0,i.jsx)(G,{...e})}),H=e=>{let{kind:t,ordinal:n,mode:l,multiSelectModeOn:r,onCopyLinkToStep:o,isConfirmingDelete:s,hovered:a,selected:c,onSelectedChange:d,handleShiftClick:u,selectDisabled:h,isEditing:p,isTranscribing:x,isGuiding:m=!1}=e,[f,v]=(0,g.useState)(!1),[b,_]=(0,g.useState)(!1),y=(0,B.N9)(),j=(0,D.m)(l)&&a&&!y||!s&&(0,D.m)(l)&&!y&&r,w=!c&&!r&&!p&&!(0,D.m)(l)&&"recording"!==l;return(0,i.jsx)(P.pn,{children:(0,i.jsxs)(P.u,{open:w&&b,onOpenChange:e=>{_(e&&w)},children:[(0,i.jsx)(P.aJ,{children:(0,i.jsx)("div",{children:(0,i.jsx)(W,{kind:t,ordinal:n,onCopyLinkToStep:o,setIsCopied:v,multiSelectModeOn:r,selected:c,onSelectedChange:d,selectDisabled:h,handleShiftClick:u,shouldShowCheckbox:j,mode:l,isMobileDevice:y,isCopied:f,isTranscribing:x})})}),!m&&(0,i.jsx)(P.NM,{children:(0,i.jsx)(P._v,{side:"left",variant:"compact",children:f?"Copied":"Copy Link to Step"})})]})})};let Y=e=>{var t;let n=null!==(t=null==e?void 0:e.split(" "))&&void 0!==t?t:[];if(n.length>2){let e=n.slice(-2).join(" "),t=n.slice(0,-2).join(" ");return(0,i.jsxs)(i.Fragment,{children:[t," ",(0,i.jsx)("span",{className:"text-slate-400",children:e})]})}return e};var q=e=>{let{text:t}=e;return(0,i.jsxs)("div",{className:"flex h-full items-center",children:[(0,i.jsx)("p",{className:(0,j.cn)("public-sans m-0 text-base",{"text-slate-400":!t}),children:t?Y(t):"Listening..."})," "]})};let J=e=>"warning"===e?"text-red-900 font-medium text-base ":"tip"===e?"text-green-900 font-medium text-base ":"instruction"===e?"text-slate-800":"text-slate-800 font-normal text-base",$=e=>{let{id:t,kind:n,description:l,hasTranscribedText:r,isTranscribing:o,ordinal:s,mode:a,multiSelectModeOn:c,onCopyLinkToStep:d,isConfirmingDelete:u,hovered:h,selected:p,onSelectedChange:x,handleShiftClick:m,selectDisabled:f,isEmbedded:v,isGuiding:_=!1}=e,[y,k]=(0,g.useState)(!1),[S,C]=(0,g.useState)(l),{scribeFile:E}=(0,b.v9)(O.Q),{refetch:N}=(0,M.ol)(null==E?void 0:E.id),{mutateAsync:T}=(0,R.s1)(),I="newActionPlaceholderId"===t,L=(0,D.m)(a)&&!c&&!I;return(0,i.jsxs)("div",{className:"flex w-full flex-grow flex-row items-start bg-opacity-0 pr-4 font-sans","data-testid":"actionDescription",children:[(0,i.jsx)(H,{kind:o?"disabled":n,ordinal:s,onCopyLinkToStep:d,multiSelectModeOn:c,selected:p,onSelectedChange:x,selectDisabled:f,handleShiftClick:m,mode:a,isConfirmingDelete:u,hovered:h,isEditing:y,isTranscribing:o,isGuiding:_}),o?(0,i.jsx)(q,{text:l}):(0,i.jsx)("div",{className:(0,j.cn)("m-0 flex w-[calc(100%_-_48px)] md:pt-[5px]",J(n),!y&&L&&"cursor-text"),children:(0,i.jsx)("div",{className:"w-full",children:(0,i.jsx)(A,{kind:n,mode:a,content:"recording"===a?l:S,canEdit:L,setIsEditing:k,updateActionDescription:e=>{let{text:n}=e;(0,w.L9)("edited_file_action",{type:"title",id:t}),void 0!==n&&C(n),T({id:t,[r?"transcribed_description":"description"]:void 0!==n?n:S}).then(()=>N())},colors:J(n),documentId:null==E?void 0:E.id,isEmbedded:v})})})]})};$.defaultProps={};let Q=(e,t)=>(0,i.jsx)("div",{className:"rounded-md bg-red-100 p-4",children:(0,i.jsx)("h1",{className:"text-red-500",children:"Something went wrong"})});var V=e=>(0,i.jsx)(L.Z,{fallback:Q,children:(0,i.jsx)($,{...e})})},9654:function(e,t,n){n.d(t,{y:function(){return o}});var i=n(53355),l=n(61165);let r=e=>{try{return!!new URL(e).protocol}catch(n){var t;return!!(null==e?void 0:null===(t=e.startsWith)||void 0===t?void 0:t.call(e,"//"))}},o=l.ZP.extend({renderHTML(e){let{HTMLAttributes:t}=e;return r(t.href)||(t.href="//".concat(t.href)),t.rel="ugc",["a",(0,i.P1)(this.options.HTMLAttributes,t),0]}});t.Z=o},37155:function(e,t,n){n.d(t,{Z:function(){return R}});var i=n(24246),l=n(83469),r=n(94033),o=n(52205),s=n(69711),a=n(73943),c=n(16354),d=n(28509),u=n(16863),h=n(43425),p=n(4238),x=n(66726),m=n.n(x),f=n(86677),g=n(27378),v=n(80833),b=n(69623),_=n(37892),y=n(22967),j=n(15597),w=n(42171),k=n(42135),S=n(43044),C=n(963),E=e=>{let{open:t=!0,onSave:n,onCancel:l,initialAltText:r,loading:o}=e,[s,a]=(0,g.useState)(r);return(0,i.jsx)(S.Vq,{open:t,children:(0,i.jsxs)(S.cZ,{children:[(0,i.jsx)(S.fK,{title:"Update image alt text",description:"Alt text (alternative text) makes this image accessible to those using screen reader software."}),(0,i.jsx)(S.SL,{children:(0,i.jsx)(C.o,{placeholder:"Enter alt text",label:"Alt Text",autoFocus:!0,fullWidth:!0,className:"w-full",value:s,onChange:e=>a(e.target.value)})}),(0,i.jsx)(S.cN,{primaryAction:{children:o?"Saving...":"Save",loading:o,disabled:o,onClick:()=>n(s)},secondaryAction:{children:"Cancel",disabled:o,onClick:l}})]})})},N=n(1581),T=e=>{let{onClick:t,children:n,ariaLabel:l,toolTipText:r}=e;return(0,i.jsx)(N.pn,{children:(0,i.jsxs)(N.u,{children:[(0,i.jsx)(N.aJ,{children:(0,i.jsx)("button",{className:"duration-400 relative z-20 flex h-10 w-10 cursor-pointer flex-col items-center justify-center rounded-full bg-slate-800 bg-opacity-30 text-center leading-4 text-white backdrop-blur-sm transition-opacity",onClick:e=>{e.stopPropagation(),null==t||t()},"aria-label":null!=l?l:"",children:n})}),(0,i.jsx)(N._v,{side:"right",variant:"default",children:(0,i.jsx)("div",{children:null!=r?r:""})})]})})},I=e=>{let{currentScaleFactor:t,minScaleFactor:n,maxScaleFactor:o,scaleFactorStep:s,visible:a,onChange:c}=e;return(0,i.jsxs)("div",{className:"duration-400 absolute bottom-2 right-2 flex h-20 w-10 cursor-pointer flex-col items-center justify-around rounded-full bg-slate-800 bg-opacity-30 bg-clip-padding p-1.5 backdrop-blur-sm transition-opacity",style:{opacity:a?1:0},children:[(0,i.jsx)("button",{style:{color:t===o&&"rgba(255,255,255,0.5)"},onDoubleClick:e=>e.stopPropagation(),onClick:()=>{let e=parseFloat((t+s).toFixed(1));t>=n&&t<o&&c(e)},className:"-mt-1 h-6 cursor-pointer rounded-t-full bg-transparent","aria-label":"Zoom in",children:(0,i.jsx)(r.G,{icon:l.q9v,size:"lg",color:"white"})}),(0,i.jsx)("button",{style:{color:t===n&&"rgba(255,255,255,0.5)"},onDoubleClick:e=>e.stopPropagation(),onClick:e=>{e.stopPropagation();let i=parseFloat((t-s).toFixed(1));t<=o&&t>n&&c(i)},className:"-mb-1 h-6 cursor-pointer rounded-b-full bg-transparent","aria-label":"Zoom out",children:(0,i.jsx)(r.G,{icon:l.Wq6,size:"lg",color:"white"})})]})};let A=e=>{var t,n,a,x;let{isEmbedded:S=!1,isCollapsed:C=!1,isUpdatingScreenshot:N,isUpdatingError:A,...L}=e,R=(0,h.Z)(d.iS.name),M="true"===(0,f.useRouter)().query.sidepanel,O="recording"===L.mode||M,D=(0,k.m)(L.mode),[P,{width:B,height:F}]=(0,v.Z)(),{scribeFile:U,isLoading:Z}=(0,p.c)(L.scribeFileId),z=(null==U?void 0:U.click_target_color)||L.clickTargetColor||c.Qe,G=!!L.kind&&(null===(t=L.kind)||void 0===t?void 0:t.indexOf("click"))>-1,[K,W]=(0,g.useState)({x:L.drag_translate_x,y:L.drag_translate_y}),{mutateAsync:H,isLoading:Y}=(0,u.s1)(),[q,J]=(0,g.useState)(void 0),$=L.device_pixel_ratio||1,[Q,V]=(0,g.useState)(L.default_scale_factor/$),[X,ee]=(0,g.useState)(!1),[et,en]=(0,g.useState)(!1),ei=22*(L.hovered?1.25:1),el=(0,g.useRef)(),{user_cropped_screenshot:er,position:eo}=L,es=(0,g.useMemo)(()=>{let e,t;return(null==eo?void 0:eo.x)&&(null==eo?void 0:eo.y)&&(e=eo.x-((null==er?void 0:er.x)||0),t=eo.y-((null==er?void 0:er.y)||0)),{x:e,y:t}},[null==er?void 0:er.x,null==er?void 0:er.y,null==eo?void 0:eo.x,null==eo?void 0:eo.y]),ea=(0,g.useMemo)(()=>{let e={id:L.id},t=e,n=m()(()=>{H(t).then(()=>{if("number"==typeof t.drag_translate_x&&"number"==typeof t.drag_translate_y){let e={x:t.drag_translate_x,y:t.drag_translate_y};(0,w.L9)("update_pan_position",{actionId:L.id,panPosition:e})}t.default_scale_factor&&((0,w.L9)("set_default_scale_factor",{actionId:L.id,defaultScaleFactor:t.default_scale_factor}),ee(!0),setTimeout(()=>ee(!1),400))}).catch(e=>{(0,j.l)(e)}).finally(()=>{t=e})},1e3);return e=>{e.default_scale_factor&&(e.default_scale_factor*=L.device_pixel_ratio||1),Object.assign(t,e),n()}},[L.device_pixel_ratio,L.id,H]),ec=(0,g.useCallback)(e=>{let{x:t,y:n}=e;W({x:t,y:n}),D&&ea({drag_translate_x:t,drag_translate_y:n})},[D,ea]),ed=()=>{let e=S&&C?s.gc:s.e5,t=B>e?e:B,n=t/s.pI;return F<n&&C&&(t=F*s.pI,n=F),{width:t,height:S?n-10:n}},eu=O&&"WAITING"===L.screenshot_upload_status,eh=(null===(n=L.screenshot)||void 0===n?void 0:n.upload_status)==="uploaded"||!!(0,_.$7)(L);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:(0,y.cn)("mt-4 flex w-full justify-center",{"flex-1 items-center":S}),ref:P,children:(0,i.jsxs)("div",{className:(0,y.cn)("relative w-full overflow-hidden rounded-lg bg-white",S&&C&&"h-96"),style:(()=>{let{width:e,height:t}=ed();return{maxWidth:e,maxHeight:t,minHeight:t}})(),children:[(0,i.jsx)("div",{className:"absolute left-0 top-0 overflow-hidden rounded-lg",style:ed(),"data-testid":"action-screenshot",children:(L.user_cropped_screenshot||eh||eu)&&(R?(0,i.jsx)(o.D,{actionId:L.id,devicePixelRatio:L.device_pixel_ratio||1,alt:null!==(a=null==L?void 0:L.alt_text)&&void 0!==a?a:"",showClickTarget:b.n7.includes(L.kind)&&!!L.show_position_indicator,clickTarget:es,translate:K,isEditMode:D,hideControls:O,showSkeleton:eu,enableImageEditing:!L.inStack&&D&&!M,clickTargetColor:z,onTranslateChange:ec,onImageEditClick:L.onEditScreenshot,onAltEditClick:()=>en(!0),onScaleChange:e=>{D&&(ee(!0),ea({default_scale_factor:e}))}}):(0,i.jsx)(s.eY,{innerRef:el,props:L,state:{imageSize:q,currentScaleFactor:Q},setState:e=>{"imageSize"in e&&J(e.imageSize),"currentScaleFactor"in e&&V(e.currentScaleFactor)},isEmbedded:S,isUpdating:N,isError:A,showSkeleton:eu}))}),!!L.position&&!R&&!N&&(0,s.L2)({ref:el,isClick:G,props:L,state:{imageSize:q,currentScaleFactor:Q},isEmbedded:S,isLoading:Z,backgroundColor:z,circleRadius:ei}),!R&&(0,i.jsx)("div",{className:(0,y.cn)("duration-400 absolute bottom-24 right-2 flex h-10 flex-col items-center justify-around rounded-full bg-gray-800 bg-opacity-30 bg-clip-padding px-3 py-1.5 text-sm text-white backdrop-blur-xl backdrop-filter transition-opacity",{visible:X,invisible:!X}),children:(0,i.jsx)("span",{children:"Zoom Saved"})}),D&&!R&&(0,i.jsxs)("div",{className:"absolute right-2 top-2 flex flex-col gap-1",children:[!L.inStack&&(0,i.jsx)(T,{onClick:()=>{L.onEditScreenshot()},ariaLabel:"Edit Image",toolTipText:"Edit Image",children:(0,i.jsx)(r.G,{icon:l.IwR,size:"lg",color:"white"})}),(0,i.jsxs)(T,{onClick:()=>{en(!0),(0,w.L9)("opened_alt_text")},ariaLabel:"Edit Alt Text",toolTipText:"Edit Alt Text",children:[R&&(0,i.jsx)("span",{className:"ml-[-3px] bg-transparent text-white",children:"ALT"}),!R&&(0,i.jsx)("span",{className:"text-[10px] font-black leading-4 tracking-[0.15px] text-white",children:"ALT"})]})]}),!L.inStack&&!R&&(0,i.jsx)(I,{currentScaleFactor:Q,minScaleFactor:.1,maxScaleFactor:1.6,scaleFactorStep:.1,onChange:e=>{"editor"===L.mode&&(ee(!0),ea({default_scale_factor:e})),V(e)},visible:L.hovered})]})}),(0,i.jsx)(E,{open:et,onCancel:()=>en(!1),loading:Y,initialAltText:null!==(x=null==L?void 0:L.alt_text)&&void 0!==x?x:"",onSave:async e=>{e!==(null==L?void 0:L.alt_text)&&(await H({id:L.id,alt_text:e}),(0,w.L9)("updated_alt_text",{alt_text:e})),en(!1)}})]})},L=()=>(0,i.jsx)("div",{className:"rounded-md bg-red-100 p-4",children:(0,i.jsx)("h1",{className:"text-red-500",children:"Something went wrong"})});var R=(0,g.memo)(e=>(0,i.jsx)(a.Z,{fallback:L,children:(0,i.jsx)(A,{...e})}))},52138:function(e,t,n){n.d(t,{Hb:function(){return s},WE:function(){return c},XU:function(){return r},d:function(){return a},f3:function(){return i},qV:function(){return l},tA:function(){return o}});let i="theCursorIndicator",l=[.93,.54,.21,0],r=[.93,.54,.21,1],o="0.5%",s=688/384,a=40,c={backgroundColor:[.93,.54,.21,.7],disableStyle:!0,disableResize:!0,disableRotate:!0,disableFlip:!0,disableDuplicate:!0,disableReorder:!0,id:i,opacity:1,rotation:0,rx:"2.5%",ry:"2.5%",strokeColor:[.93,.54,.21,1],strokeWidth:10,x:"100%",y:"100%"}},2412:function(e,t,n){n.d(t,{UJ:function(){return c},ee:function(){return u}});var i=n(53355),l=n(22967);let r=/(?:^|\s)((?:\[\[)((?:[^*]+))(?:\]\]))$/,o=/(?:^|\s)((?:\[\[)((?:[^*]+))(?:\]\]))/g,s=/(?:^|\s)((?:{{)((?:[^__]+))(?:}}))$/,a=/(?:^|\s)((?:{{)((?:[^__]+))(?:}}))/g,c=e=>{let{isLink:t=!1,isEditing:n=!1,isEmbedded:i=!1,isSubtitle:r=!1}=e;return(0,l.cn)("font-semibold rounded border px-[5px] text-sm align-bottom",t?(0,l.cn)("relative pr-5 truncate w-fit group-[.is-focused]:max-w-none group-[.is-focused]:text-clip  group-[.is-focused]:whitespace-normal group-[.is-focused]:pr-[5px] mx-1  no-underline break-all inline-block leading-[14px] py-1 ",{"rounded border border-slate-500 bg-white/10":r,"border-blue-200 bg-blue-50 text-blue-700 hover:border-blue-300 hover:text-blue-800":!r}):(0,l.cn)("whitespace-break-spaces break-words inline leading-6 py-[3px]",{"rounded border border-slate-500":r,"border-slate-200 bg-slate-50 text-slate-800":!r}),n?"pr-[5px]":"",i?"max-w-[400px]":"md:max-w-[400px] max-w-full")},d=(e,t,n)=>{let i=e.slice(t+2,n);return(i=(i=(i=(i=i.replace(/\\\[/g,"[")).replace(/\\\]/g,"]")).replace(/\\\\/g,"\\")).replace(/\\\*/g,"*")).includes("\\+")&&(i=i.replace(/\\\+/g,"+")),i.includes("\\-")&&(i=i.replace(/\\\-/g,"-")),i},u=i.vc.create({name:"chip",keepOnSplit:!1,addOptions:()=>({HTMLAttributes:{},isSubtitle:!1}),addStorage:()=>({markdown:{serialize:{open:"[[",close:"]]"},parse:{setup(e){e.inline.ruler.push("double_brackets",(e,t)=>{let{src:n}=e,{pos:i}=e;if("["!==n[i]||"["!==n[i+1])return!1;let l=n.indexOf("]]",i+2);return -1!==l&&(t||(e.push("double_brackets","",0).content=d(n,i,l)),e.pos=l+2,!0)}),e.renderer.rules.double_brackets=(e,t)=>'<span class="'.concat(c({isSubtitle:this.options.isSubtitle}),'">').concat(e[t].content,"</span>"),e.inline.ruler.push("double_braces",(e,t)=>{let{src:n}=e,{pos:i}=e;if("{"!==n[i]||"{"!==n[i+1])return!1;let l=n.indexOf("}}",i+2);return -1!==l&&(t||(e.push("double_braces","",0).content=d(n,i,l)),e.pos=l+2,!0)}),e.renderer.rules.double_braces=e.renderer.rules.double_brackets}}}}),addAttributes(){return{class:{default:c({isSubtitle:this.options.isSubtitle})}}},parseHTML:()=>[{tag:"span"}],renderHTML(e){let{HTMLAttributes:t}=e;return["span",(0,i.P1)(this.options.HTMLAttributes,t),0]},addCommands(){return{setChip:()=>e=>{let{commands:t}=e;return t.setMark(this.name)},toggleChip:()=>e=>{let{commands:t}=e;return t.toggleMark(this.name)},unsetChip:()=>e=>{let{commands:t}=e;return t.unsetMark(this.name)}}},addKeyboardShortcuts(){return{"Mod-[":()=>this.editor.commands.toggleChip()}},addInputRules(){return[(0,i.Cf)({find:r,type:this.type}),(0,i.Cf)({find:s,type:this.type})]},addPasteRules(){return[(0,i.K9)({find:o,type:this.type}),(0,i.K9)({find:a,type:this.type})]}})},52205:function(e,t,n){n.d(t,{D:function(){return D}});var i=n(24246),l=n(83469),r=n(94033),o=n(48913),s=n(20685),a=n(16354),c=n(27378),d=n(16125),u=n(8022),h=n(1581),p=n(22967),x=n(27855),m=n(42171);let f=e=>{let{show:t=!0}=e;return(0,i.jsx)("div",{className:(0,p.cn)("left-1 mt-[2px] flex h-4 flex-row items-center justify-center overflow-hidden transition-all duration-300 ease-out",{"opacity-100":t,"opacity-0":!t,"mr-0":!t,"mr-1":t}),style:{width:t?"16px":"0"},children:(0,i.jsx)(r.G,{className:"h-4 w-4 text-green-500 transition-transform",style:{transform:t?"translateX(0)":"translateX(-16px)"},icon:l.LEp})})},g=e=>{let{content:t,animationPhase:n}=e;return(0,i.jsx)("span",{className:(0,p.cn)("transition-all duration-300 ease-out",{"opacity-0":"growing"===n||"fadeOut"===n},{"opacity-100":"growing"!==n&&"fadeOut"!==n}),children:t})},v=e=>{let{icon:t,children:n,ariaLabel:l,disabled:o,onClick:s,className:a}=e;return(0,i.jsx)("button",{style:{color:o?"rgba(255,255,255,0.5)":"white"},"aria-labelledby":"screenshot-button",onDoubleClick:e=>e.stopPropagation(),onClick:s,className:(0,p.cn)("h-8 w-8 rounded-full bg-transparent p-2 text-center font-sans text-xs font-bold leading-4",{"cursor-default":o,"cursor-pointer":!o,"hover:bg-slate-800 hover:bg-opacity-10":!o,className:a}),"aria-label":null!=l?l:"",disabled:o,tabIndex:o?-1:0,children:null!=n?n:(0,i.jsx)(r.G,{icon:t,size:"lg",className:"scale-90 transform"})})},b={growing:200,successDelay:150,successDuration:900,fadeOut:5},_=e=>new Promise(t=>{setTimeout(t,e)}),y=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Zoom saved",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3e3,[i,l]=(0,c.useState)(e),[r,o]=(0,c.useState)(!1),[s,a]=(0,c.useState)(!1),[d,u]=(0,c.useState)("initial"),[h,p]=(0,c.useState)(!1),x=(0,c.useRef)(Promise.resolve()),m=(0,c.useRef)(!1),f=(0,c.useCallback)(async()=>{m.current||(o(!0),u("growing"),await _(b.growing),u("success"),l(t),await _(b.successDelay),p(!0),await _(b.successDuration-b.successDelay),u("fadeOut"),await _(b.fadeOut),o(!1),l(e),p(!1),u("initial"),m.current=!0,await _(n),m.current=!1)},[t,e,n]),g=(0,c.useCallback)(e=>{"growing"!==e||r||m.current||(x.current=x.current.then(f))},[r,f]);return(0,c.useEffect)(()=>{l(e)},[e]),{tooltipContent:i,showTooltip:(r||s)&&!m.current,animationPhase:d,showCheckmark:h,setShowTooltip:e=>{m.current||a(e)},setShowConfirmationTooltip:e=>{m.current||o(e)},startAnimationPhase:g}},j=e=>{let{children:t,className:n="",dataTestId:l}=e,r=(0,p.cn)("duration-400 z-100 flex w-10 cursor-pointer flex-col items-center justify-around rounded-full bg-slate-800 bg-opacity-30 bg-clip-padding p-1.5 backdrop-blur-sm transition-opacity",n);return(0,i.jsx)(h.pn,{children:(0,i.jsx)("div",{className:r,"data-testid":l,children:t})})};var w=e=>{let{icon:t,disabled:n,onClick:l,label:r,confirmation:o,children:s,ariaLabel:a,className:d,dataTestId:u}=e,[p,x]=(0,c.useState)(!1),{tooltipContent:m,showTooltip:b,animationPhase:_,showCheckmark:j,setShowTooltip:w,setShowConfirmationTooltip:k,startAnimationPhase:S}=y(r),C=!n&&b,E=(0,c.useCallback)(e=>{e.stopPropagation(),!n&&(l(e),o&&(k(!0),S("growing")))},[n,l,o,k,S]),N=(0,c.useCallback)(()=>{n||(w(!0),x(!0))},[n,w]),T=(0,c.useCallback)(()=>{w(!1),x(!1)},[w]);return(0,i.jsxs)(h.u,{open:C&&p,children:[(0,i.jsx)(h.aJ,{asChild:!0,"data-testid":u,children:(0,i.jsx)("div",{onMouseEnter:N,onBlur:T,onFocus:N,onMouseLeave:T,children:(0,i.jsx)(v,{icon:t,disabled:n,onClick:E,ariaLabel:a,className:d,children:s})})}),(0,i.jsx)(h.NM,{children:(0,i.jsx)(h._v,{side:"right",className:"transition-all ease-out",style:{transitionDuration:"100ms, 300ms",transitionProperty:"width, opacity"},children:o?(0,i.jsxs)("div",{className:"relative flex max-w-32 justify-start",children:[(0,i.jsx)(f,{show:j&&"success"===_}),(0,i.jsx)(g,{content:m,animationPhase:_})]}):(0,i.jsx)("span",{children:r})})})]})},k=n(69711);let S=e=>{let{onClick:t,children:n,icon:l,ariaLabel:r,toolTipText:o,dataTestId:s}=e;return(0,i.jsx)(j,{className:"size-11","data-testid":s,children:(0,i.jsx)(w,{icon:l,onClick:e=>{e.stopPropagation(),null==t||t()},ariaLabel:null!=r?r:"",label:null!=o?o:"",children:n})})};var C=n(77597),E=n(61555);let N=e=>{let{actionId:t,isRecording:n,message:l}=e,r=(0,d.I0)();if(n)return"Image failed to upload. Recapture or edit step later.";if(void 0===l)return E.c;let o=()=>r((0,u.Bo)({actionId:t,open:!0})),s=()=>r((0,u.Kd)({recordAfterActionId:t,showRecorderSelectionModal:!0}));return(0,C.L)(l)?(0,i.jsxs)("span",{children:["Image failed to upload. Try refreshing page,"," ",(0,i.jsx)("span",{className:"cursor-pointer font-bold hover:text-indigo-600",onClick:o,children:"uploading an image"})," ","or"," ",(0,i.jsx)("span",{className:"cursor-pointer font-bold hover:text-indigo-600",onClick:s,children:"recapturing the step"}),"."]}):(0,C.h)(l)?(0,i.jsxs)("span",{children:["Image is invalid. Try"," ",(0,i.jsx)("span",{className:"cursor-pointer font-bold hover:text-indigo-600",onClick:o,children:"uploading a different image"})," ","or"," ",(0,i.jsx)("span",{className:"cursor-pointer font-bold hover:text-indigo-600",onClick:s,children:"recapturing the step"}),"."]}):l},T=(e,t)=>{let n=new RegExp("(\\.\\d{{".concat(t-1,"})\\d*"));return+"".concat(e).replace(n,(e,t)=>t)},I=e=>{let{scale:t,minScale:n=.1,showSaveMessage:r,onChange:o,className:s}=e,a=T(n+1.5,1),c=e=>i=>{i.stopPropagation();let l=t+("in"===e?.1:-.1),r=l<n&&n||l>a&&a||l;"in"===e&&l<=a?o(r):"out"===e&&o(r)};return(0,i.jsxs)(j,{className:(0,p.cn)("absolute bottom-2 right-2 h-20",s),children:[(0,i.jsx)(w,{icon:l.q9v,disabled:t+.1>a,onClick:c("in"),label:"Zoom in",confirmation:r?"Zoomed in":void 0,dataTestId:"zoom-in-button"}),(0,i.jsx)(w,{icon:l.Wq6,disabled:t<=n,onClick:c("out"),label:"Zoom out",confirmation:r?"Zoomed out":void 0,dataTestId:"zoom-out-button"})]})},A=e=>"object"==typeof e&&"x"in e&&"y"in e&&"number"==typeof e.x&&"number"==typeof e.y,L=(e,t)=>{let n=Math.floor(255*t).toString(16).padStart(2,"0");return"".concat(e).concat(n)},R=()=>(0,i.jsxs)("div",{children:[(0,i.jsx)(r.G,{icon:l.$pG,size:"lg",className:"mr-1 scale-90 transform text-[#818CF8]"}),"Drag to Pan"]}),M=()=>(0,i.jsxs)("div",{className:"flex items-center","data-testid":"pan-saved-tooltip",children:[(0,i.jsx)(f,{show:!0}),"Panning Saved"]}),O=e=>{let{x:t,y:n,color:l,animate:r}=e,o=l||a.Qe;return(0,i.jsx)("div",{"data-testid":"action-click-target",className:(0,p.cn)("pointer-events-none absolute left-0 top-0 size-11 overflow-hidden rounded-full border-2 transition-transform duration-300 will-change-[translate] group-hover:scale-125",r?"transition-[translate,transform]":"transition-transform"),style:{translate:"calc(-50% + ".concat(t,"px) calc(-50% + ").concat(n,"px)"),borderColor:L("#".concat(o),.75),backgroundColor:L("#".concat(o),.5)}})},D=e=>{var t,n,a,f,g,v;let{alt:b,devicePixelRatio:_,actionId:y,translate:j,clickTarget:w,showClickTarget:C,isEditMode:E,hideControls:T,showSkeleton:L,clickTargetColor:D,onTranslateChange:P,enableImageEditing:B,onImageEditClick:F,onAltEditClick:U,onScaleChange:Z,disableInitialTransition:z}=e,G=(0,c.useRef)(null),K=(0,c.useRef)(null),[W,H]=(0,c.useState)(!1),[Y,q]=(0,c.useState)(!1),[J,$]=(0,c.useState)(z),[Q,V]=(0,c.useState)((0,i.jsx)(R,{})),X=(0,d.I0)(),ee=(0,d.v9)(e=>(0,u.fC)(e,y)),et=ee.values.screenshotUrl,{loaded:en,errored:ei}=ee.screenshotState,el=en&&!ei,er=(null===(t=K.current)||void 0===t?void 0:t.naturalWidth)||0,eo=(null===(n=K.current)||void 0===n?void 0:n.naturalHeight)||0,es=(null===(a=G.current)||void 0===a?void 0:a.clientWidth)||0,ea=(null===(f=G.current)||void 0===f?void 0:f.clientHeight)||0,ec=(null!==(v=ee.values.screenshotScale)&&void 0!==v?v:1)/_,ed=e=>{null==Z||Z(e),X((0,u.J_)({actionId:y,screenshotScale:e*_}))},eu=es/k.e5,eh=ec*eu,ep=Math.min(es/er,ea/eo)/eu;(0,o.e)(G);let ex=(0,c.useMemo)(()=>new x.E({x:er,y:eo}),[er,eo]),em=(0,c.useMemo)(()=>new x.E({x:es,y:ea}),[es,ea]),ef=(0,c.useCallback)((e,t)=>{let{x:n,y:i}=t,l=ex.multipliedBy(e),r=l.x>em.x,o=l.y>em.y,s=em.subtract(l),a=r?s.x/2:0,c=o?s.y/2:0;return{x:Math.min(Math.max(n,a),-a),y:Math.min(Math.max(i,c),-c)}},[ex,em]),eg=A(j)&&new x.E(j)||A(w)&&ex.dividedBy(2).subtract(new x.E(w)).multipliedBy(eh)||new x.E({x:0,y:0}),{x:ev,y:eb}=ef(eh,eg),e_=ex.multipliedBy(eh),ey=em.subtract(e_),ej=A(w)&&new x.E(w).multipliedBy(eh).add(ey.dividedBy(2)).add({x:ev,y:eb}),ew=e_.x>es,ek=e_.y>ea,eS=E&&(ew||ek),eC=!T&&(ew||ek),eE=(0,c.useCallback)(e=>{if(e.preventDefault(),!eC||0!==e.button)return;H(!0);let t=e.clientX-ev,n=e.clientY-eb,l=e=>{let{clientY:i,clientX:l}=e;null==P||P(ef(eh,{x:l-t,y:i-n}))},r=()=>{H(!1),document.removeEventListener("mousemove",l),document.removeEventListener("mouseup",r),q(!0),eS&&V((0,i.jsx)(M,{}))};document.addEventListener("mousemove",l),document.addEventListener("mouseup",r)},[eC,ev,eb,ef,eh,P,eS]);(0,c.useEffect)(()=>{if(!Y)return;let e=setTimeout(()=>{q(!1),setTimeout(()=>{V((0,i.jsx)(R,{}))},300)},1e3);return()=>clearTimeout(e)},[Y]);let eN=null===(g=ee.errors.screenshotUrl)||void 0===g?void 0:g[0];return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{ref:G,className:"group relative flex size-full items-center justify-center",children:[(0,i.jsxs)("div",{className:"relative flex size-full items-center justify-center bg-slate-100","data-testid":"draggable-screenshot-image",children:[(0,i.jsx)(s.M,{ref:K,src:et,alt:b,forceLoading:L||!en,onMouseDown:eE,onLoad:()=>X((0,u.lg)({actionId:y,loaded:!0,errored:!1})),onError:()=>X((0,u.lg)({actionId:y,loaded:!0,errored:!0})),className:(0,p.cn)("relative flex size-full transform-gpu select-none items-center justify-center rounded-lg transition-opacity duration-300",{"transition-[translate,scale] will-change-[translate,scale]":!W&&!J},!eC&&"default"||(W?"cursor-grabbing":"cursor-grab")),style:{width:"".concat(er,"px"),height:"".concat(eo,"px"),translate:"".concat(ev,"px ").concat(eb,"px"),scale:"".concat(eh)},errorStyle:{width:"100%",height:"100%",translate:"0px 0px",scale:"none"},errorMessage:eN&&(0,i.jsx)(N,{actionId:y,isRecording:T,message:eN})}),el&&ej&&C&&(0,i.jsx)(O,{x:ej.x,y:ej.y,color:D,animate:!W})]}),!T&&B&&(0,i.jsxs)("div",{className:"absolute right-2 top-2 flex flex-col gap-1",children:[B&&F&&(0,i.jsx)(S,{icon:l.IwR,onClick:F,ariaLabel:"Edit Image",toolTipText:"Edit Image",children:(0,i.jsx)(r.G,{icon:l.IwR,size:"lg",color:"white"})}),(0,i.jsx)(S,{onClick:()=>{null==U||U(),(0,m.L9)("opened_alt_text")},ariaLabel:"Edit Alt Text",toolTipText:"Edit Alt Text",children:(0,i.jsx)("span",{className:"ml-[-3px] bg-transparent text-white",children:"ALT"})})]}),!T&&el&&(0,i.jsx)(I,{scale:ec,minScale:ep,showSaveMessage:E,onChange:e=>{if($(!1),ej){let{x:t,y:n}=ex.dividedBy(2).subtract(new x.E(w)).multipliedBy(e);null==P||P(ef(e,{x:t,y:n}))}else if(A(j)){let{x:t,y:n}=new x.E(j).multipliedBy(e/ec);null==P||P(ef(e,{x:t,y:n}))}else null==P||P({x:0,y:0});ed(e)}})]}),eC&&(0,i.jsx)("div",{className:"absolute bottom-0 left-0 right-0 z-20 mb-4 flex justify-center","data-testid":"draggable-screenshot-tooltip",children:(0,i.jsx)(h.pn,{children:(0,i.jsxs)(h.u,{open:W||Y,children:[(0,i.jsx)(h.aJ,{asChild:!0,children:(0,i.jsx)("div",{})}),(0,i.jsx)(h._v,{side:"top",className:"pl-[-32px]",children:Q})]})})}),(0,i.jsx)("div",{className:"pointer-events-none absolute inset-0 rounded-lg shadow-inner"})]})}},46815:function(e,t,n){n.d(t,{Z:function(){return Y}});var i=n(24246),l=n(18378),r=n(52138),o=n(69711),s=n(20685),a=n(48913),c=n(22967),d=n(27378),u=n(37322);let h=()=>(0,i.jsx)("div",{className:"pointer-events-none absolute left-1/2 top-1/2 flex h-16 w-16 -translate-x-1/2 -translate-y-1/2 flex-col items-center justify-center rounded-full bg-black bg-opacity-50 text-white",children:(0,i.jsx)(u.cuI,{size:40,color:"white",className:"ml-1 opacity-75"})});var p=e=>{var t;let{src:n,hovered:l,description:u}=e,p=(0,d.useRef)(null),x=(0,d.useRef)(null),[m,f]=(0,d.useState)(!1),g=(0,d.useRef)(null);(0,a.e)(p);let v=((null===(t=p.current)||void 0===t?void 0:t.clientWidth)||o.e5)/r.Hb;return(0,i.jsxs)("div",{className:"relative mt-4 flex size-full max-h-96 justify-center overflow-hidden rounded-lg bg-slate-100",style:{height:v},ref:p,children:[(0,i.jsx)("canvas",{ref:x,className:(0,c.cn)("object-contain",{hidden:!m||l})}),(0,i.jsx)(s.M,{ref:g,src:n,alt:u,className:(0,c.cn)("object-contain",{hidden:m&&!l}),onLoad:()=>{let e=()=>{new Promise(e=>{x.current.width=g.current.width,x.current.height=g.current.height,x.current.getContext("2d").drawImage(g.current,0,0),f(!0),e(void 0)}).catch(()=>setTimeout(e,1e3))};e()}}),(0,i.jsx)("div",{className:"absolute inset-0 rounded-md shadow-inner"}),m&&!l&&(0,i.jsx)(h,{})]})},x=n(73943),m=n(16863),f=n(55766),g=n(4238),v=n(21404),b=n(16125),_=n(73606),y=n(8022),j=n(48407),w=n(23067),k=n(37892),S=n(42171),C=n(30218),E=n(14616),N=n(42135),T=n(71203),I=n(22333),A=n(43044),L=n(963),R=n(93910);let M=e=>{let t;try{t=new URL(e)}catch(e){return}return"".concat(t.protocol,"//").concat(t.hostname).concat(t.port?":".concat(t.port):"")};var O=e=>{let{onSave:t,onCancel:n,initialUrl:l}=e,r=M(l),[o,s]=(0,d.useState)(!1),[a,c]=(0,d.useState)(r),[u,h]=(0,d.useState)(l);return(0,i.jsx)(A.Vq,{open:!0,onOpenChange:n,children:(0,i.jsxs)(A.cZ,{children:[(0,i.jsx)(A.fK,{title:"Update Guide Me link",description:"When viewers with the Scribe extension click the Guide Me button on this step, this URL will open in a new tab with the scribe displayed in a panel overlay."}),(0,i.jsxs)(A.SL,{children:[(0,i.jsx)(L.o,{placeholder:"https://example.com/getting-started",label:"URL",autoFocus:!0,fullWidth:!0,className:"w-full",value:u,onChange:e=>{h(e.target.value),c(M(e.target.value))}}),r&&r!==a&&(0,i.jsxs)("div",{className:"flex gap-2",children:[(0,i.jsx)(R.Z,{id:"update-all",checked:o,onValueChange:e=>s(e)}),(0,i.jsxs)("label",{htmlFor:"update-all",children:["Change domain from ",(0,i.jsx)("span",{className:"font-semibold text-indigo-500",children:r})," to"," ",(0,i.jsx)("span",{className:"font-semibold text-indigo-500",children:a||"the new domain"})," for all steps."]})]})]}),(0,i.jsx)(A.cN,{primaryAction:{children:"Save",onClick:()=>{t(u.startsWith("https://")||u.startsWith("http://")?u:"https://".concat(u),o?a:void 0,o?r:void 0)}},secondaryAction:{children:"Cancel",onClick:n}})]})})},D=n(62136),P=n(35094),B=n(83469),F=n(94033),U=n(35286),Z=e=>{let{message:t,onBringMeBack:n,documentId:l,actionId:r}=e;return(0,i.jsx)("div",{children:(0,i.jsxs)("div",{className:(0,U.cn)("mt-4 flex items-start rounded-md border border-solid border-indigo-200 bg-indigo-50 p-3 text-xs font-medium"),children:[(0,i.jsx)(F.G,{icon:B.DBf,className:"h-[14px] w-[14px] p-px leading-4 text-indigo-500"}),(0,i.jsxs)("div",{children:[(0,i.jsx)("span",{className:"ml-2 text-slate-800",children:t}),t===_.zD.UrlMismatch&&(0,i.jsx)(j.z,{variant:"secondary",size:"small",className:"mt-1.5",onClick:()=>{(0,S.L9)("clicked_different_page_fallback_guide_me",{documentId:l,actionId:r}),n()},children:"Bring me back"})]})]})})},z=n(37155),G=n(12068),K=e=>{let{action:t}=e;return(0,i.jsx)(j.z,{onClick:()=>{(0,S.L9)("submit_transcription",{step:t.ordinal}),(0,G.MK)({messageType:"action",action:{...t,kind:"instruction",id:void 0,description:"",timestamp:new Date().valueOf(),transcribed_description:"",isTranscribing:!1,url:t.url}})},className:"mt-4 w-full",size:"small",variant:"secondary",children:"Next"})};let W=e=>{let{isConfirmingDelete:t,setIsConfirmingDelete:n,selected:r,onSelectedChange:o,handleShiftClick:s,commentSection:a,scribeFile:u,multiSelectModeOn:h,timestamp:x,hovered:A,setAddScreenshotVisible:L,onCopyLinkToStep:R,onAddScreenshot:M,onDownloadScreenshotUnavailable:B,isDownloadScreenshotUnavailable:F,id:U,showGuideMeStepNotFoundMsg:G=!1,guideMeStepNotFoundMsg:W,isGuiding:H=!1,showNext:Y,onRecaptureStep:q,navigateTabToActionUrlFromExtension:J,...$}=e,{recaptureStep2024q4:Q}=(0,b.v9)(l.F),V=(0,b.I0)(),[X,ee]=(0,d.useState)(!1),[et,en]=(0,d.useState)(!1),[ei,el]=(0,d.useState)(!1),{visibleActions:er}=(0,b.v9)(y.JR),{duplicateSelectedActions:eo,isDuplicatingError:es,setIsDuplicatingError:ea}=(0,f.ol)(null==u?void 0:u.id),{refetchScribeFile:ec}=(0,g.c)(null==u?void 0:u.id),{scrollToAction:ed}=(0,v.Z)({visibleActions:er,scribeFileId:null==u?void 0:u.id}),{mutate:eu}=(0,m.s1)(),eh=(null==u?void 0:u.permission)===D.yz.Owner||D.yz.Write,ep=(0,k.$7)($),ex=!h&&(0,N.m)($.mode)&&!t&&"newActionPlaceholderId"!==U,em=ex&&!ep&&!(null==$?void 0:$.external_screenshot_url),ef=$.isTranscribing?$.transcribed_description:$.transcribed_description||$.description,eg=!!ep||"recording"===$.mode&&"WAITING"===$.screenshot_upload_status,ev=!(null==$?void 0:$.external_screenshot_url)&&("stack"!==$.kind&&eg||"stack"===$.kind&&eg&&!(0,w.sY)(ep));return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(I.Z,{isOpen:es,onOpenChange:()=>ea(!es),onPrimaryActionClick:()=>ea(!1)}),(0,i.jsxs)("div",{className:(0,c.cn)("box-border flex h-auto w-full flex-col rounded-2xl bg-white p-4 shadow",t&&"rounded-none rounded-b-2xl",G&&"ring-2 ring-inset ring-indigo-400"),children:[(0,i.jsxs)("div",{className:"flex w-full flex-row",children:[(0,i.jsx)(P.Z,{...$,id:U,kind:$.kind,description:ef,hasTranscribedText:!!$.transcribed_description,ordinal:$.ordinal,mode:$.mode,multiSelectModeOn:h,onCopyLinkToStep:R,isConfirmingDelete:t,hovered:A,selected:r,onSelectedChange:o,handleShiftClick:s,selectDisabled:$.selectDisabled,isEmbedded:$.isEmbedded,isGuiding:H}),ex&&(0,i.jsx)(C.Z,{onDelete:()=>n(!0),...em&&{onAddScreenshot:M},className:ei?"opacity-100":"opacity-0",children:(0,i.jsx)(E.Z,{onStepActionMenuClick:el,isStepWithScreenshot:!!ep||!!(null==$?void 0:$.external_screenshot_url),onUpdateGuideMe:()=>en(!0),onUnstack:"stack"===$.kind?()=>ee(!0):void 0,onCopyLinkToStep:R,isDownloadScreenshotUnavailable:F,onDownloadScreenshot:()=>F?null==B?void 0:B("stack"===$.kind?"download_file":"download_screenshot"):(0,k.GN)({action:{...$,id:U},scribeFile:u}),onDownloadFullScreenshot:()=>F?null==B?void 0:B("download_full_screenshot"):(0,k.KI)({action:$,scribeFile:u}),onDuplicate:async()=>{let e=null==er?void 0:er.findIndex(e=>e.id===U),t=await eo([U],e);(0,S.L9)("duplicate_scribe_steps",{location:"step_tridot",document_id:null==u?void 0:u.id,actionIds:t}),setTimeout(()=>{ed(t[0])},200)},setAddScreenshotVisible:L})}),x&&(0,i.jsx)("span",{className:(0,c.cn)("mr-4 text-sm text-blueGray-500",{"mr-[60px]":(0,N.m)($.mode)}),children:x})]}),ev&&(0,i.jsx)(z.Z,{id:U,scribeFileId:null==u?void 0:u.id,...$,hovered:A}),(null==$?void 0:$.external_screenshot_url)&&(0,i.jsx)("div",{className:"flex w-full justify-center",children:(0,i.jsx)("img",{alt:"external-screenshot",className:"mt-2 max-h-[360px] max-w-full rounded md:min-h-[360px]",src:null==$?void 0:$.external_screenshot_url})}),"stack"===$.kind&&!!ep&&(0,w.sY)(ep)&&(0,i.jsx)(p,{src:ep,hovered:A,description:$.description}),Y&&(0,i.jsx)(K,{action:{id:U,...$}}),a,G&&!!W&&(0,i.jsx)(Z,{message:W,onBringMeBack:J,documentId:u.id,actionId:U}),Q&&eh&&G&&W===_.zD.NotFoundScreenshot&&(0,i.jsx)(j.z,{className:"mt-4 w-full",variant:"secondary",size:"default",onClick:q,children:"Recapture Step"})]}),X&&(0,i.jsx)(T.Z,{variant:"danger",title:"Confirm Split",description:"Are you sure you want to split this stack into its original steps?",actionTitle:"Split into Steps",cancelTitle:"Cancel",showCancel:!0,onAction:()=>{let e;e=er[er.length-1].id===U?$.stack_actions[$.stack_actions.length-1].id:er[er.length-1].id;let t={id:U,stack_actions:$.stack_actions};V((0,y.H0)({stack:t})).then(()=>{ec(),V((0,y.Tf)({documentId:null==u?void 0:u.id,toActionId:e}))}),ee(!1),(0,S.L9)("edited_file_unstacked_actions",{file_id:u.id})},onCancel:()=>{ee(!1)},visible:X}),et&&(0,i.jsx)(O,{onCancel:()=>en(!1),onSave:(e,t,n)=>{eu({id:U,url:e,new_domain_for_all:t,old_domain_to_replace:n}),en(!1),(0,S.L9)("updated_guide_me_link",{file_id:U,url:e,location:"step_tridot"})},initialUrl:$.url})]})},H=()=>(0,i.jsx)("div",{children:"Error in action"});var Y=e=>(0,i.jsx)(x.Z,{fallback:H,children:(0,i.jsx)(W,{...e})})},69711:function(e,t,n){n.d(t,{pI:function(){return p},gc:function(){return m},e5:function(){return x},eY:function(){return v},L2:function(){return b}});var i=n(24246),l=n(60074),r=n(20685),o=n(27378),s=n(25971),a=n(23067),c=n(22967),d=n(95351);function u(e,t,n,i){let l,r;let o=t*i,s=n*i;return e>o?(l=s+(e-o)/2,r=(e-o)/2):s>=e/2&&s<o-e/2?(l=e/2,r=-(s-e/2)):s<e/2?(l=s,r=0):s>=o-e/2&&(l=s-(o-e),r=-(o-e)),[l,r]}var h=n(37892);let p=n(52138).Hb,x=688,m=1920,f=e=>{var t,n,i,l,r,o,s;let{element:a,action:c,imageSize:d,scaleFactor:h,isPreview:p=!1,scaleToHeight:m=!1}=e,f=null==a?void 0:a.clientWidth,g=null==a?void 0:a.clientHeight,v=f/x,b=h*v,_=d;if(m&&_){let e=g/(_.height/_.width);_={width:e,height:g},b=(e/d.width+g/d.height)/2}let{position:y}=c,j=!1;y||(j=!0,y=_?{x:_.width/2,y:_.height/2}:{x:0,y:0});let{x:w,y:k}=y,{width:S,height:C}=c.user_cropped_screenshot?c.user_cropped_screenshot:_||{width:0,height:0};p||!c.user_cropped_screenshot||j||(w=y.x-c.user_cropped_screenshot.x,k=y.y-c.user_cropped_screenshot.y);let E=parseFloat(((null!==(i=null==c?void 0:null===(n=c.user_cropped_screenshot)||void 0===n?void 0:null===(t=n.screenshot_editor_state)||void 0===t?void 0:t.rotation)&&void 0!==i?i:0)/Math.PI%2).toFixed(1));if(S&&C){if(1===E)w=S-w,k=C-k;else if(.5===E){let e=w;w=S-k,k=e}else if(1.5===E){let e=w;w=k,k=C-e}}let[N,T]=u(f,null!==(l=null==d?void 0:d.width)&&void 0!==l?l:0,w,null!=b?b:1),[I,A]=u(g,null!==(r=null==d?void 0:d.height)&&void 0!==r?r:0,k,null!=b?b:1);return{additionalScaleFactor:v,updatedScaleFactor:b,container:{width:f,height:g},screenPosition:{vertical:A,horizontal:T},mousePosition:{x:N,y:I},scaledImageSize:m?_:{width:Math.ceil(null!==(o=null==_?void 0:_.width)&&void 0!==o?o:0*b),height:Math.ceil(null!==(s=null==_?void 0:_.height)&&void 0!==s?s:0*b)}}},g=e=>{let{element:t,action:n,imageSize:i,scaleFactor:l,scaleToHeight:r=!1}=e;if(!i)return{};let{updatedScaleFactor:o,screenPosition:s}=f({element:t,action:n,imageSize:i,scaleFactor:l,scaleToHeight:r});return{top:s.vertical,left:s.horizontal,width:i.width*o,height:i.height*o}},v=e=>{var t;let{innerRef:n,props:l,state:a,setState:d,isEmbedded:u=!1,isUpdating:p,isError:x,showSkeleton:m}=e,f=(0,h.$7)(l),[v,b]=(0,o.useState)(!1);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"relative h-full",ref:n,children:(0,i.jsx)(r.M,{src:f,forceLoading:m,onLoad:()=>{let e=n.current.firstChild;b(!1),setTimeout(()=>{d({imageSize:{width:e.naturalWidth,height:e.naturalHeight}})},20)},className:(0,c.cn)("absolute left-0 top-0 overflow-hidden",{"transition-none":l.stiff,"transition-all":!u}),onError:()=>{b(!0)},style:g({element:null==n?void 0:n.current,imageSize:a.imageSize,action:l,scaleFactor:a.currentScaleFactor}),alt:null!==(t=null==l?void 0:l.alt_text)&&void 0!==t?t:""})}),(p||x)&&(0,i.jsxs)("div",{className:(0,c.cn)("absolute bottom-0 left-0 right-0 top-0 flex items-center justify-center",{"bg-black bg-opacity-70 backdrop-blur-md backdrop-filter":p||x,"shadow-inner":!v}),"data-testid":"image-bounce-loader",children:[p&&(0,i.jsx)(s.BounceLoader,{size:32,color:"#A5B4FC"}),x&&!p&&(0,i.jsx)("p",{className:"text-lg font-bold text-white",children:"There was an error updating the screenshot. Please try editing again."})]})]})},b=e=>{let{ref:t,isClick:n,props:r,state:o,isEmbedded:s=!1,isLoading:u,backgroundColor:h,circleRadius:p}=e,{updatedScaleFactor:x,screenPosition:m,mousePosition:g}=f({element:t.current,imageSize:o.imageSize,action:r,scaleFactor:o.currentScaleFactor});if((n||"stack"===r.kind&&!(0,a.sY)(r.screenshot_url))&&o.imageSize&&r.show_position_indicator){let e={width:Math.ceil(o.imageSize.width*x),height:Math.ceil(o.imageSize.height*x)},{vertical:t,horizontal:n}=m;if(g.x>n+e.width||g.y>t+e.height||g.x<n||g.y<t)return(0,i.jsx)("div",{});let a=g.y-p,f=g.x-p;if(0===a&&0===f){let t={top:a,left:f,mousePosition:JSON.stringify(g),scaledRadius:p,scaledImageSize:JSON.stringify(e),screenPosition:JSON.stringify(m)};l.uT("Resizing circle has a top and left of 0",{extra:t})}return(0,i.jsx)("div",{className:(0,c.cn)("absolute left-0 top-0 h-0 w-0 rounded-none border-2",{"transition-none":r.stiff,"transition-all":!s}),style:{backgroundColor:u?"none":(0,d.E9)(h,.3),border:u?"none":"2px solid ".concat((0,d.E9)(h,100)),top:a,left:f,width:2*p,height:2*p,borderRadius:2*p}})}return(0,i.jsx)("div",{})}},20685:function(e,t,n){n.d(t,{M:function(){return d}});var i=n(24246),l=n(83469),r=n(94033),o=n(27378),s=n(25971),a=n(22967),c=n(61555);let d=(0,o.forwardRef)((e,t)=>{let{src:n,alt:d,className:u,errorMessage:h,onLoad:p,onError:x,style:m,errorStyle:f,forceLoading:g,...v}=e,[b,_]=(0,o.useState)(0),[y,j]=(0,o.useState)(!1),[w,k]=(0,o.useState)(!1),S="".concat(n,"|").concat(b);return w?(0,i.jsxs)("div",{title:d,className:(0,a.cn)("flex size-full select-none flex-col items-center justify-center gap-6 bg-white px-6 text-center",u),style:{...m,...f},"data-testid":"image-src-not-ready-error",children:[(0,i.jsx)(r.G,{icon:l.ik8,fontSize:36,className:"text-yellow-500"}),h||c.c]},S):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("img",{ref:t,"data-testid":"src-error-count-".concat(b),src:n,alt:d,className:(0,a.cn)({hidden:!y||g},u),style:m,onLoad:e=>{j(!0),null==p||p(e)},onError:e=>{b>=6?(k(!0),null==x||x(e)):setTimeout(()=>_(e=>e+1),2e3)},...v},S),(!y||g)&&(0,i.jsx)("div",{className:(0,a.cn)("pointer-events-none absolute inset-0 flex size-full items-center justify-center bg-black bg-opacity-70 shadow-inner backdrop-blur-md backdrop-filter md:max-w-full",u),"data-testid":"image-bounce-loader",children:(0,i.jsx)(s.BounceLoader,{size:32,color:"#A5B4FC"})})]})})},61555:function(e,t,n){n.d(t,{c:function(){return i}});let i="There was an error loading this image. Reload the page to try again."},29088:function(e,t,n){n.d(t,{Z:function(){return u}});var i=n(24246),l=n(83469),r=n(27378),o=n(78483),s=n(43044),a=n(79369),c=n(22967),d=n(10975),u=e=>{let{value:t,onCancel:n,onSubmit:u,onChange:h,onRemoveLink:p}=e,[x,m]=(0,r.useState)(!1),f=()=>{let e=(null==t?void 0:t.startsWith("mailto"))?(0,d.Ju)(null==t?void 0:t.slice(7,null==t?void 0:t.length)):(0,d.xF)(t);if(!t||!(null==t?void 0:t.length)||!e){m(!0);return}u((null==t?void 0:t.startsWith("mailto"))||t.includes("http")||t.includes("www.")?t:"//".concat(t))};return(0,i.jsx)(s.Vq,{open:!0,onOpenChange:n,children:(0,i.jsxs)(s.cZ,{children:[(0,i.jsx)(s.fK,{title:"Add link"}),(0,i.jsxs)(s.SL,{children:[(0,i.jsx)(a.I,{name:"url",onKeyDownCapture:e=>{"Enter"===e.key&&f()},value:t,onChange:e=>{m(!1),h(e)},autoFocus:!0,className:"w-full",onFocus:()=>m(!1),"data-testid":"insert-link"}),(0,i.jsx)(o.j,{variant:"destructive",className:(0,c.cn)("transition-all",x?"visible max-h-10 opacity-100":"invisible max-h-0 p-0 opacity-0"),icon:l.FO3,"data-testid":"error-banner",children:"Please enter a valid URL."})]}),(0,i.jsx)(s.cN,{primaryAction:{children:"Save Link",onClick:f,testId:"submit-button"},secondaryAction:{children:"Remove",onClick:p}})]})})}},16354:function(e,t,n){n.d(t,{J9:function(){return l},Qe:function(){return i},y3:function(){return r}});let i="FB923C",l=["F43F5E","EC4899","8B5CF6","0EA5E9","14B8A6","22C55E","EAB308",i],r=["4299E1","667EEA","22D3EE","10B981","FBBF24","F97316","FB7185","E879F9","C4B5FD"]},16863:function(e,t,n){n.d(t,{s1:function(){return d}});var i=n(56552),l=n(22172);n(56985),n(27378),n(55260),n(19783),n(52929),n(56069),n(50565),n(31928),n(42171);var r=n(8022),o=n(83469),s=n(60074),a=n(16125),c=n(53826);let d=()=>{let e=(0,a.I0)(),t=(0,i.useQueryClient)(),{toast:n}=(0,c.pm)();return(0,i.useMutation)({mutationFn:t=>{let{id:n,...i}=t;return e(r.Gx.pending(null,{id:n,...i})),l.Z.updateAction(n,i)},onError:(t,i)=>{let{id:l}=i;e({type:r.Gx.rejected.type,payload:void 0,error:t,meta:{arg:{id:l}}}),s.Tb(t,{tags:{location:"useActionUpdateMutation"}}),n({title:"Your update has not saved",description:"A network error occurred. Please make the update again to ensure it saves.",variant:"warning",icon:o.eHv})},onSuccess:(n,i)=>(e(r.Gx.fulfilled(i.collapsed?{...n,collapsed:!0}:n,null,i)),t.invalidateQueries("actions"))})};n(70385),n(45719)},55766:function(e,t,n){n.d(t,{ZP:function(){return o},ol:function(){return r.Z}});var i=n(56552),l=n(22172),r=n(9201),o=e=>(0,i.useQuery)({queryKey:["action",e],queryFn:()=>l.Z.fetchAction(e),enabled:!!e})},9201:function(e,t,n){var i=n(21947),l=n(27378),r=n(56552),o=n(16125),s=n(70385),a=n(56069),c=n(98753),d=n(8022),u=n(53826),h=n(17498),p=n(50106);t.Z=e=>{let t=(0,o.I0)(),[n,x]=(0,l.useState)(!1),m=(0,r.useQuery)({queryKey:["simplified_actions",e],queryFn:()=>c.Z.listSimplifiedActions(e),enabled:!!e,refetchInterval:0}),{data:f}=m,g=async n=>{let i=n.map(e=>{let t={};return t.id=e.id,t});try{let n=(await s.Z.reorderActions(e,i)).actions.sort((e,t)=>e.sort_order-t.sort_order);t((0,d.NF)(n)),await m.refetch()}catch(e){console.error("Failed to reorder actions",e)}},v=(e,t,n)=>{let i=e.findIndex((e,n)=>"section"===e.kind&&n>t),l=e.slice(t,-1!==i?i:void 0),r=[...e];return r.splice(t,l.length),r.splice(t>=n?n:n-l.length+1,0,...l),r},b=async(e,t,n)=>{let i=[],l=f[t];return i=(null==e?void 0:e.length)>1?(0,h.a)(f,e,{index:t},{index:n}):"section"===l.kind&&l.collapsed?v(f,t,n):(0,p.HP)(f,t,n),await g(i),i},_=async e=>{var t,n;let i=null==f?void 0:null===(t=f.filter)||void 0===t?void 0:t.call(f,t=>!(null==e?void 0:e.map(e=>e.id).includes(t.id))),l=[...null==f?void 0:null===(n=f.filter)||void 0===n?void 0:n.call(f,t=>null==e?void 0:e.map(e=>e.id).includes(t.id)),...i];await g(l)},y=async e=>{var t,n;let i=[...null==f?void 0:null===(t=f.filter)||void 0===t?void 0:t.call(f,t=>!(null==e?void 0:e.map(e=>e.id).includes(t.id))),...null==f?void 0:null===(n=f.filter)||void 0===n?void 0:n.call(f,t=>null==e?void 0:e.map(e=>e.id).includes(t.id))];await g(i)},j=async(e,t,n)=>{let i=e.filter(e=>!t.includes(e.id)),l=e.filter(e=>t.includes(e.id));return i.splice(n,0,...l),await g(i),i},w=async(t,n)=>{try{let i=await a.Z.copyActionsToDocument({actionIds:t,scribeDocumentId:e}),l=await c.Z.listSimplifiedActions(e);return await j(l,i,n+1),i}catch(t){throw console.error("Failed to duplicate actions to Scribe: ".concat(e),t),t}},k=async(t,n)=>{x(!1);try{let e=await w(t,n);return(0,u.Am)({title:"Success!",description:t.length<=1?"".concat(t.length," step duplicated"):"".concat(t.length," steps duplicated"),icon:i.fV7,variant:"success"}),e}catch(t){throw console.error("Failed to duplicate actions to Scribe: ".concat(e),t),x(!0),t}};return{...m,moveActionsToTop:_,moveActionsToBottom:y,updateActionOrder:g,getActionIndexById:e=>null==f?void 0:f.findIndex(t=>t.id===e),dropActions:b,getActionById:e=>null==f?void 0:f.find(t=>t.id===e),duplicateSelectedActions:k,isDuplicatingError:n,setIsDuplicatingError:x,actions:f}}},85087:function(e,t,n){n.d(t,{Z:function(){return o}});var i=n(56552),l=n(23042),r=async e=>l.Sl.get("app_tag/search/",{url:e},!0),o=e=>{let t=!!e&&e.includes(".");return(0,i.useQuery)(["appTagSearch",e],()=>r(e),{enabled:t})}},48913:function(e,t,n){n.d(t,{e:function(){return r}});var i=n(27378),l=()=>{let[,e]=(0,i.useState)(!1);return(0,i.useCallback)(()=>e(e=>!e),[])};let r=e=>{let t=l();(0,i.useEffect)(()=>{let n=null==e?void 0:e.current;if(!n)return;let i=new ResizeObserver(t);return i.observe(n),()=>i.unobserve(n)},[t,e])}},21404:function(e,t,n){n.d(t,{Z:function(){return a}});var i=n(54062),l=n(86677),r=n(27378),o=n(16125),s=n(8022),a=e=>{let{visibleActions:t,scribeFileId:n}=e,{altApi:a}=(0,l.useRouter)().query,{data:c}=(0,i.ZP)(),d=(0,o.I0)(),u=(0,r.useCallback)(()=>"true"===a||null!=c&&!!c.email&&(null==c?void 0:c.isDesktopOnly),[null==c?void 0:c.email,a]),h=async function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return document.getElementById(e.split("-")[0])||(i<10?(await d((0,s.Sv)({scribeDocumentId:n,skip:t.length,fetchUntilElementWithHash:e,useAlternativeApi:u()})),h(e,i+1)):null)};return{scrollToAction:async e=>{let t=await h(e);t&&t.scrollIntoView?t.scrollIntoView({behavior:"smooth",block:"start"}):console.warn("Could not find action with id: ".concat(e))},scrollToTop:()=>{window.scrollTo({top:0,behavior:"smooth"})}}}},56069:function(e,t,n){var i=n(45719);t.Z={copyActionsToDocument:async e=>{let{scribeDocumentId:t,actionIds:n}=e;return(0,i.Z)("scribe_documents/".concat(t,"/paste"),"POST",!0,{actions:n})}}},27855:function(e,t,n){n.d(t,{E:function(){return i}});class i{add(e){return new i({x:this.x+e.x,y:this.y+e.y})}subtract(e){return new i({x:this.x-e.x,y:this.y-e.y})}multipliedBy(e){return new i({x:this.x*e,y:this.y*e})}dividedBy(e){return new i({x:this.x/e,y:this.y/e})}constructor({x:e,y:t}){this.x=e,this.y=t}}},37892:function(e,t,n){n.d(t,{$7:function(){return o},GN:function(){return s},KI:function(){return a}});var i=n(70385),l=n(42171);let r=async(e,t,n)=>{let i=await fetch(t,{cache:"no-cache"}),l=await i.blob(),r=URL.createObjectURL(l),o=document.createElement("a");if(o.href=r,n)o.download="".concat(e,".png");else{let n=t.split(".")[t.split(".").length-1].split("?")[0];o.download="".concat(e,".").concat(n)}document.body.appendChild(o),o.click(),document.body.removeChild(o)},o=e=>{var t;return"user_cropped_screenshot"in e&&(null===(t=e.user_cropped_screenshot)||void 0===t?void 0:t.url)||"screenshot_url"in e&&e.screenshot_url||"external_screenshot_url"in e&&e.external_screenshot_url},s=async e=>{let{action:t,scribeFile:n}=e,s=o(t);if(!s)return;if("stack"===t.kind)return(0,l.L9)("downloaded_step_file",{file_id:t.id,location:"step_tridot"}),r("".concat(n.name," - Step ").concat(t.ordinal),s);let a=await i.Z.getMouseScreenshot(null==t?void 0:t.id);if(a)return(0,l.L9)("downloaded_step_image",{file_id:t.id,location:"step_tridot"}),r("".concat(n.name," - Step ").concat(t.ordinal),null==a?void 0:a.screenshot_url,!0)},a=e=>{let{action:t,scribeFile:n}=e;t.screenshot_url&&(r("".concat(n.name," - Step ").concat(t.ordinal),t.screenshot_url),(0,l.L9)("downloaded_full_step_image",{file_id:t.id,location:"step_tridot"}))}},17498:function(e,t,n){n.d(t,{T:function(){return i},a:function(){return l}});let i=e=>{let t=[],n=!1;return e.forEach(e=>{"section"===e.kind?(e.selected&&(t.push(e),e.collapsed&&(n=!0)),e.selected&&e.collapsed||(n=!1)):(n||e.selected)&&t.push(e)}),t},l=(e,t,n,i)=>{let l=e[n.index],r=(()=>{let n=t.reduce((t,n)=>n.id===l.id||e.findIndex(e=>e.id===n.id)>=i.index?t:t+1,0);return i.index-n})(),o={};e.forEach((e,t)=>{o[e.id]=t});let s=[...t];s.sort((e,t)=>{let n=o[e.id],i=o[t.id];return n!==i?n-i:-1});let a={};t.forEach(e=>{a[e.id]=e});let c=e.filter(e=>!a[e.id]);return(()=>{let e=[...c];return e.splice(r,0,...s),e})()}},95351:function(e,t,n){n.d(t,{E9:function(){return r},KF:function(){return i},Sv:function(){return o},pL:function(){return l}});let i=e=>(null==e?void 0:e.length)===3?e.replace(/([0-9a-f])/gi,"$1$1"):e,l=e=>!!e&&/^#?([0-9a-f]{6})$/i.test(i(e)),r=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(!l(e))return"rgba(0,0,0,0)";let n=e.replace("#",""),i=parseInt(3===n.length?n.slice(0,1).repeat(2):n.slice(0,2),16),r=parseInt(3===n.length?n.slice(1,2).repeat(2):n.slice(2,4),16),o=parseInt(3===n.length?n.slice(2,3).repeat(2):n.slice(4,6),16);return"rgba(".concat(i,",").concat(r,",").concat(o,",").concat(t,")")},o=e=>{if(!l(e))return[0,0,0];let t=e.replace("#","");return[parseInt(3===t.length?t.slice(0,1).repeat(2):t.slice(0,2),16)/255,parseInt(3===t.length?t.slice(1,2).repeat(2):t.slice(2,4),16)/255,parseInt(3===t.length?t.slice(2,3).repeat(2):t.slice(4,6),16)/255,.7]}},14222:function(e,t,n){n.d(t,{Lg:function(){return a},PW:function(){return s},Bv:function(){return x},xW:function(){return m}});var i,l,r,o=n(81019);(i=l||(l={})).PRESS="keyboard_action",i.SEQUENCE="keyboard_sequence_action",i.COMBINATION="keyboard_combination_action",(r||(r={})).CLICK="mouse_click_action";let s=e=>{var t;return e.download_url||(null===(t=e.screenshot)||void 0===t?void 0:t.download_url)||null},a=(e,t,n)=>{var i,l;let r=s(e);return{...e,id:t,screenshot_url:"SUCCESS"===e.screenshot_upload_status?r:null,screenshot:"SUCCESS"===e.screenshot_upload_status&&{id:"".concat(t,"-screenshot"),upload_status:"uploaded",download_url:r},timestamp:"",description:e.description||function(e){if("mouse_click_action"===e.kind)return"right"===e.button&&1===e.click_count?"Right-click ".concat(d(e.target_text)):"right"===e.button&&2===e.click_count?"Right-double-click ".concat(d(e.target_text)):"middle"===e.button&&1===e.click_count?"Middle-click ".concat(d(e.target_text)):"middle"===e.button&&2===e.click_count?"Middle-double-click ".concat(d(e.target_text)):1===e.click_count?"Click ".concat(d(e.target_text)):2===e.click_count?"Double-click ".concat(d(e.target_text)):"Click ".concat(d(e.target_text));if("keyboard_sequence_action"===e.kind){let t='Type "';if(e.keys&&e.keys.some(e=>e)){for(let n of e.keys)n.length>1?t+=" [[".concat(n,"]] "):t+=n;t=t.trim()+'"'}else t="Type";return t.trim()}if("keyboard_combination_action"===e.kind){let t="Press";if(!e.keys||!e.keys.some(e=>e))return t;let n=[];for(let t of e.keys)n.push("[[".concat(t,"]]"));return"".concat(t," ").concat(n.join(" + "))}if("instruction"===e.kind){var t;return(null===(t=e.url)||void 0===t?void 0:t.length)&&e.description.startsWith("Navigate to")?"Navigate to ".concat(c(e.url)):""}return null}(e),transcribed_description:null===(l=e.transcribed_description)||void 0===l?void 0:null===(i=l.trim)||void 0===i?void 0:i.call(l),showNext:e.isTranscribing&&(null==n?void 0:n.showTranscriptionSubmit)}},c=e=>{if(!e)return"";let t=e.split("?")[0];return"[".concat(t,"](").concat(e,")")},d=e=>{var t,n;let i=null==e?void 0:e.trim();return i?'"'.concat((0,o.vn)(null===(n=i.split("\n"))||void 0===n?void 0:null===(t=n[0])||void 0===t?void 0:t.trim(),20),'"'):"here."};var u=n(12068),h=n(42171),p=n(1010);let x=()=>new URLSearchParams(new URL(window.location.href).search).get("url"),m=(e,t)=>{switch((null==t?void 0:t.track)&&(0,h.L9)(t.track.name,t.track.data),e){case p.L.COMPLETE_CAPTURE:(0,u.MK)({messageType:"browserCompleteCapture"});break;case p.L.STOP_RECORDING_SHOW_BILLING:(0,u.MK)({messageType:"browserStopRecording"});break;case p.L.DELETE_RECORDING:(0,u.MK)({messageType:"browserDeleteRecording"});break;case p.L.BLUR_CAPTURE:(0,u.MK)({messageType:"browserBlurCapture"});break;case p.L.PAUSE_CAPTURE:(0,u.MK)({messageType:"browserPauseCapture"})}}},1010:function(e,t,n){var i,l;n.d(t,{L:function(){return i}}),(l=i||(i={})).COMPLETE_CAPTURE="COMPLETE_CAPTURE",l.STOP_RECORDING_SHOW_BILLING="STOP_RECORDING_SHOW_BILLING",l.DELETE_RECORDING="DELETE_RECORDING",l.BLUR_CAPTURE="BLUR_CAPTURE",l.PAUSE_CAPTURE="PAUSE_CAPTURE",l.OPEN_DESKTOP="OPEN_DESKTOP"},55781:function(e,t,n){var i=n(24246),l=n(94033),r=n(22967);t.Z=e=>{let{onClick:t,isActive:n,isActiveDetails:o,icon:s,activeIcon:a,editor:c,children:d,dataTestID:u}=e,h=n&&(null==c?void 0:c.isActive(n,o||{}));return(0,i.jsxs)("button",{"data-testid":u,onClick:t,className:(0,r.cn)("flex h-[27px] w-[27px] cursor-pointer items-center justify-center rounded-sm transition-colors duration-100",h?"bg-indigo-600 hover:bg-indigo-500 shadow-sm shadow-indigo-950 text-white":"bg-slate-800 text-slate-300 hover:bg-slate-700 hover:text-slate-100 text-slate-300"),children:[d,(0,i.jsx)(l.G,{icon:h?a:s,className:"drop-shadow-[0px_1px_2px_0px_rgba(30,27,75,0.50) text-sm"})]})}},30218:function(e,t,n){var i=n(24246),l=n(83469);n(27378);var r=n(28897),o=n(22967);t.Z=e=>{let{onDelete:t,onAddScreenshot:n,className:s,children:a}=e;return(0,i.jsxs)(r.CC,{"data-testid":"stepActionMenu",className:(0,o.cn)("absolute right-3 top-3 opacity-0 focus:opacity-100 group-focus:opacity-100",s),children:[n&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.vt,{icon:l.VmB,onClick:n,"data-testid":"add-screenshot"}),(0,i.jsx)(r.o$,{})]}),t&&(0,i.jsx)(r.vt,{icon:l.XAH,onClick:t,"data-testid":"delete-step-action"}),a&&(0,i.jsxs)(i.Fragment,{children:[t&&(0,i.jsx)(r.o$,{}),a]})]})}},14616:function(e,t,n){var i=n(24246),l=n(22107),r=n(28509),o=n(43425),s=n(83449),a=n(28897),c=n(7131),d=n(97153),u=n(42171);t.Z=e=>{let{onUnstack:t,onCopyLinkToStep:n,onDownloadScreenshot:h,onDownloadFullScreenshot:p,onUpdateGuideMe:x,onDuplicate:m,isDownloadScreenshotUnavailable:f,isStepWithScreenshot:g,onStepActionMenuClick:v,setAddScreenshotVisible:b}=e,_=(0,o.Z)(r.t$.name);return(0,i.jsxs)(s.h_,{modal:!1,onOpenChange:e=>v(e),children:[(0,i.jsx)(s.$F,{asChild:!0,children:(0,i.jsx)(a.vt,{icon:l.S6C})}),(0,i.jsxs)(s.AW,{align:"start",sideOffset:8,children:[m&&(0,i.jsx)(s.Xi,{onClick:m,children:"Duplicate Step"}),(0,i.jsx)(s.Xi,{onClick:n,children:"Copy Link to Step"}),x&&(0,i.jsx)(s.Xi,{onClick:x,children:(0,i.jsxs)("div",{children:["Update ",(0,i.jsx)("span",{className:"italic",children:"Guide Me"})," Link"]})}),g&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.VD,{theme:d.b.Dark}),!t&&_&&(0,i.jsx)(s.Xi,{onClick:()=>{b(!0),(0,u.L9)("clicked_replace_image",{location:"step_tridot"})},children:(0,i.jsx)("div",{className:"flex w-full items-center",children:"Replace Image"})}),h&&(0,i.jsx)(s.Xi,{onClick:h,children:(0,i.jsxs)("div",{className:"flex w-full items-center",children:[t?(0,i.jsx)(i.Fragment,{children:"Download File"}):(0,i.jsx)(i.Fragment,{children:"Download Image"}),f&&(0,i.jsx)(c.g,{variant:"dark",className:"ml-2"})]})}),!t&&p&&(0,i.jsx)(s.Xi,{onClick:p,children:(0,i.jsxs)("div",{className:"flex w-full items-center",children:["Download Full Image ",f&&(0,i.jsx)(c.g,{variant:"dark",className:"ml-2"})]})})]}),t&&(0,i.jsx)(s.Xi,{onClick:t,children:"Split into Steps"})]})]})}},42135:function(e,t,n){function i(e){return"editor"===e||"editor_sidebar_hidden"===e}function l(e){return"editor"===e?"editor_sidebar_hidden":"editor"}n.d(t,{G:function(){return l},m:function(){return i}})},22333:function(e,t,n){n.d(t,{Z:function(){return o}});var i=n(24246),l=n(77253);n(27378);var r=n(43044),o=e=>{let{isOpen:t,onOpenChange:n,onPrimaryActionClick:o}=e;return(0,i.jsx)(r.Vq,{open:t,onOpenChange:n,children:(0,i.jsxs)(r.cZ,{className:"w-[400px]",children:[(0,i.jsx)(r.fK,{title:"Something went wrong",description:(0,i.jsxs)("p",{children:["Please try again later. If the issue persists,"," ",(0,i.jsx)("a",{href:l.av,target:"_blank",rel:"noreferrer",className:"cursor-pointer break-all text-indigo-600 hover:text-indigo-700",children:"contact support"}),"."]})}),(0,i.jsx)(r.cN,{primaryAction:{children:"Okay",onClick:o}})]})})}}}]);